model:
  name: "HR Capacity Model"
  version: "0.1.0"
  run_tags: ["dev", "step1-4"]
  timezone: "America/Los_Angeles"

data_files:
  workforce_forecast_csv: "data/workforce_forecast.csv"
  capacity_schedule_csv: "data/capacity_schedule.csv"
  events_config_csv: "data/events_config.csv"
  fixed_event_counts_csv: "data/fixed_event_counts.csv"
  routing_matrix_csv: "data/routing_matrix.csv"

step1_decision_spec:
  decision_statement: "Will HR service demand exceed sustainable capacity within the planning horizon, and where should leadership intervene to prevent operational risk?"
  horizon:
    start_date: "2026-01-01"
    periods: 13
    frequency: "W-MON"
  scope:
    in_scope:
      - workforce_growth
      - attrition
      - leaves
      - hiring
      - benefits_lifecycle
      - employee_relations
      - compliance_reporting
    out_of_scope:
      - individual_targeting
      - performance_evaluation
      - auto_decisioning
      - manager_blame_attribution
  governance:
    human_in_loop_required: true
    no_individual_targeting: true
    intended_use: "Workforce planning and HR service capacity risk management"
    prohibited_use:
      - "Individual employee actioning"
      - "Disciplinary decision automation"

inputs:
  workforce_forecast:
    unit: "employees"
    by_period: [1500, 1505, 1510, 1520, 1530, 1540, 1545, 1550, 1560, 1570, 1580, 1590, 1600]

step2_demand:
  load_unit: "service_hours"
  events:
    - event_type: "new_hire_onboarding"
      count_model:
        type: "rate_per_employee"
        rate_per_employee_per_period: 0.004
      effort_hours:
        base: 2.0
      routing:
        recruiter: 0.60
        hrbp: 0.15
        benefits: 0.15
        hrops: 0.10

    - event_type: "termination"
      locked_event: true
      count_model:
        type: "rate_per_employee"
        rate_per_employee_per_period: 0.0025
      effort_hours:
        base: 1.5
      routing:
        hrbp: 0.55
        recruiter: 0.20
        benefits: 0.10
        hrops: 0.15

    - event_type: "leave_case"
      locked_effort: true
      count_model:
        type: "rate_per_employee"
        rate_per_employee_per_period: 0.0015
      effort_hours:
        base: 4.0
      routing:
        benefits: 0.80
        hrbp: 0.20

    - event_type: "er_case"
      locked_event: true
      count_model:
        type: "fixed"
        counts_by_period: [ 2, 2, 2, 3, 2, 3, 2, 2, 3, 2, 2, 3, 2 ]
      effort_hours:
        base: 10.0
      routing:
        hrbp: 1.0

    - event_type: "aca_reporting_spike"
      count_model:
        type: "fixed"
        counts_by_period: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 0]
      effort_hours:
        base: 2.5
      routing:
        hrops: 0.70
        benefits: 0.30

step3_capacity:
  hours_per_fte_per_period: 40.0
  roles:
    recruiter:
      fte_by_period: [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
      availability_factor: 0.72
      buffer_rate: 0.12
    hrbp:
      fte_by_period: [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
      availability_factor: 0.60
      buffer_rate: 0.15
    benefits:
      fte_by_period: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
      availability_factor: 0.66
      buffer_rate: 0.15
    hrops:
      fte_by_period: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
      availability_factor: 0.76
      buffer_rate: 0.10

  sustainability_thresholds:
    green_max_utilization: 0.80
    yellow_max_utilization: 0.95

step4_scenarios:
  enabled: true

  constraints:
    no_effort_reduction_events:
      - "leave_case"
      - "termination"
      - "er_case"

  scenarios:
    - name: "baseline"
      description: "No changes"
      patches: []

    - name: "add_hrbp_0_5_fte_week5"
      description: "Add 0.5 HRBP FTE starting period index 4 (week 5)"
      patches:
        - op: "set_fte_from_period"
          path: "step3_capacity.roles.hrbp.fte_by_period"
          start_period_index: 4
          add: 0.5

    - name: "hrbp_earlier_add_0_25_week4"
      description: "Add 0.25 HRBP starting week 4"
      patches:
        - op: "set_fte_from_period"
          path: "step3_capacity.roles.hrbp.fte_by_period"
          start_period_index: 3
          add: 0.25

    - name: "recruiting_contractor_10hrs_weeks3to6"
      description: "Add 10 scheduled hours per period to recruiter capacity for periods 2 to 5"
      patches:
        - op: "add_scheduled_hours_window"
          role: "recruiter"
          start_period_index: 2
          end_period_index: 5
          add_hours_per_period: 10

    - name: "hiring_freeze_reduce_onboarding_50pct"
      description: "Reduce onboarding counts by 50% starting period index 3 (week 4)"
      patches:
        - op: "scale_event_counts_from_period"
          event_type: "new_hire_onboarding"
          start_period_index: 3
          factor: 0.50

    - name: "stabilization_combo_moderate"
      description: >
          Moderate stabilization package:
          25% hiring throttle and 0.25 HRBP FTE added starting week 6.
          ER effort is not reduced by design.
      patches:
        - op: "scale_event_counts_from_period"
          event_type: "new_hire_onboarding"
          start_period_index: 3
          factor: 0.75

        - op: "set_fte_from_period"
          path: "step3_capacity.roles.hrbp.fte_by_period"
          start_period_index: 5
          add: 0.25

    - name: "stabilization_refined_early_capacity"
      description: >
          Final refinement scenario:
          20% hiring throttle starting week 4
          and 0.25 HRBP FTE added earlier (week 4).
          Tests timing sensitivity with minimal disruption.
      patches:
          # 1) Moderate hiring throttle (lighter than prior runs)
        - op: "scale_event_counts_from_period"
          event_type: "new_hire_onboarding"
          start_period_index: 3   # week 4
          factor: 0.80            # 20% reduction

          # 2) Earlier fractional HRBP capacity (timing test)
        - op: "set_fte_from_period"
          path: "step3_capacity.roles.hrbp.fte_by_period"
          start_period_index: 3   # week 4
          add: 0.25
